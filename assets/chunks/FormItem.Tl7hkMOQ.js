import{A as te,V as oe,z as le,B as s,a3 as ne,N as P,O as N,a4 as re,H as h,K as v,a5 as E,F as ie,W as O,Q as de,a6 as se,U as K}from"./theme.BC2FFivQ.js";import{u as ue}from"./useFieldValue.BFGxFaoG.js";import{F as ce,a as me}from"./FormTitle.CWAb377c.js";import{d as pe,c as n,f as fe,k as r,F as he,w,a0 as ve}from"./framework.CxVxXlAM.js";const L={text:["type","disabled","addonAfter","addonBefore","allowClear","bordered","clearIcon","defaultValue","id","prefix","showCount","maxlength","status","size","suffix","placeholder","autocomplete","onPressEnter","onFocus","onBlur","onInput","onClear"],digit:["disabled","addonAfter","addonBefore","bordered","clearIcon","controls","decimalSeparator","formatter","keyboard","max","min","parser","precision","step","stringMode","upIcon","downIcon","defaultValue","id","prefix","status","placeholder","onPressEnter","onStep","onFocus","onBlur","onInput","onClear"],digitRange:["separatorWidth","separator","disabled","addonAfter","addonBefore","bordered","clearIcon","controls","decimalSeparator","formatter","keyboard","max","min","parser","precision","step","stringMode","upIcon","downIcon","defaultValue","id","prefix","status","placeholder","onPressEnter","onStep","onFocus","onBlur","onInput","onClear"],select:["id","pagination","placeholder","disabled","allowClear","autoClearSearchValue","autofocus","bordered","clearIcon","defaultActiveFirstOption","defaultOpen","popupClassName","dropdownMatchSelectWidth","dropdownMenuStyle","dropdownRender","dropdownStyle","fieldNames","filterOption","filterSort","firstActiveValue","getPopupContainer","labelInValue","listHeight","maxTagCount","maxTagPlaceholder","maxTagTextLength","menuItemSelectedIcon","mode","notFoundContent","open","option","optionFilterProp","optionLabelProp","options","placement","removeIcon","searchValue","showArrow","showSearch","size","status","suffixIcon","tagRender","tokenSeparators","virtual","onBlur","onFocus","onDeselect","onDropdownVisibleChange","onInputKeyDown","onMouseenter","onMouseleave","onPopupScroll","onSearch","onSelect"],textarea:["id","disabled","allowClear","autoSize","defaultValue","showCount","maxlength","placeholder","onPressEnter","onFocus","onBlur","onInput","onClear"],password:["id","disabled","addonAfter","addonBefore","allowClear","bordered","clearIcon","defaultValue","id","visibilityToggle","prefix","showCount","maxlength","status","size","suffix","placeholder","autocomplete","onPressEnter","onFocus","onBlur","onInput","onClear"],treeSelect:["id","multiple","options","showCheckedStrategy","searchPlaceholder","replaceFields","loadData","filterTreeNode","placeholder","disabled","allowClear","popupClassName","defaultValue","dropdownMatchSelectWidth","dropdownStyle","fieldNames","getPopupContainer","labelInValue","listHeight","maxTagCount","maxTagPlaceholder","notFoundContent","placement","searchValue","showSearch","size","status","suffixIcon","tagRender","title","treeCheckable","treeCheckStrictly","treeData","treeDataSimpleMode","treeDefaultExpandAll","treeDefaultExpandedKeys","treeExpandedKeys","treeIcon","treeLine","treeLoadedKeys","treeNodeFilterProp","treeNodeLabelProp","onDropdownVisibleChange","onSearch","onSelect","onTreeExpand","onUpdate:treeExpandedKeys","onUpdate:searchValue"],checkbox:["id","autofocus","disabled","indeterminate"],checkboxGroup:["id","disabled","name","options"],radioGroup:["id","class","disabled","name","options","optionType","buttonStyle","radioLabel"],cascader:["id","disabled","name","options","placeholder","allowClear","autofocus","bordered","clearIcon","changeOnSelect","defaultValue","displayRender","popupClassName","dropdownStyle","expandTrigger","fieldNames","getPopupContainer","loadData","maxTagCount","maxTagPlaceholder","multiple","notFoundContent","open","placement","showCheckedStrategy","removeIcon","searchValue","showSearch","status","suffixIcon","tagRender","onDropdownVisibleChange","onSearch"],switch:["id","checkedChildren","size","checkedValue","disabled","loading","unCheckedChildren","unCheckedValue","onClick"],slider:["id","disabled","dots","included","mark","marks","max","min","range","reverse","step","vertical","tipFormatter","tooltipPlacement","tooltipOpen","getTooltipPopupContainer","onAfterChange"],rate:["id","allowClear","allowHalf","character","count","disabled","tooltips","onBlur","onFocus","onHoverChange","onKeydown"],date:["id","allowClear","bordered","dateRender","disabled","disabledDate","format","dropdownClassName","getPopupContainer","inputReadOnly","locale","mode","nextIcon","open","picker","placeholder","placement","popupStyle","prevIcon","presets","status","suffixIcon","superNextIcon","superPrevIcon","valueFormat","defaultPickerValue","disabledTime","renderExtraFooter","showNow","showTime","showToday","monthCellRender","onOpenChange","onPanelChange","onOk"],dateRange:["allowClear","bordered","dateRender","disabled","disabledDate","format","dropdownClassName","getPopupContainer","inputReadOnly","locale","mode","nextIcon","open","picker","placeholder","placement","popupStyle","prevIcon","presets","status","suffixIcon","superNextIcon","superPrevIcon","valueFormat","id","allowEmpty","defaultPickerValue","disabledTime","presets","showTime","ranges","renderExtraFooter","separator","onOpenChange","onPanelChange","onCalendarChange","onOk"],time:["id","allowClear","bordered","clearIcon","clearText","disabled","disabledTime","format","getPopupContainer","hideDisabledOptions","hourStep","inputReadOnly","minuteStep","open","placeholder","placement","popupClassName","popupStyle","renderExtraFooter","secondStep","showNow","status","suffixIcon","use12Hours","valueFormat","onOpenChange"],timeRange:["allowClear","bordered","dateRender","disabled","disabledDate","format","dropdownClassName","getPopupContainer","inputReadOnly","locale","mode","nextIcon","open","picker","placeholder","placement","popupStyle","prevIcon","presets","status","suffixIcon","superNextIcon","superPrevIcon","valueFormat","id","allowEmpty","defaultPickerValue","disabledTime","presets","ranges","renderExtraFooter","separator","order","onOpenChange","onPanelChange","onCalendarChange","onOk"],uploadButton:["disabled","id","accept","action","beforeUpload","customRequest","data","directory","disabled","downloadIcon","fileList","headers","iconRender","isImageUrl","itemRender","listType","maxCount","method","multiple","name","openFileDialogOnClick","previewFile","previewIcon","progress","removeIcon","showUploadList","supportServerRender","withCredentials","onDownload","onDrop","onPreview","onReject","onRemove","title","max","buttonProps"],uploadDragger:["disabled","id","accept","action","beforeUpload","customRequest","data","directory","disabled","downloadIcon","fileList","headers","iconRender","isImageUrl","itemRender","listType","maxCount","method","multiple","name","openFileDialogOnClick","previewFile","previewIcon","progress","removeIcon","showUploadList","supportServerRender","withCredentials","onDownload","onDrop","onPreview","onReject","onRemove","title","description","max","buttonProps"],uploadPicture:["disabled","id","customRequest","accept","action","beforeUpload","name","headers","isCropper","cropperModalTitle","cropperModalWidth","cropperWidth","cropperHeight","cropperProps","width","height","title","data","showTitle","allowClear"],uploadPictureList:["disabled","id","data","headers","customRequest","accept","action","multiple","maxCount","beforeUpload","name","previewFile","allowClear","width","height","crossOrigin"],editor:["autofocus","indentWithTab","tabSize","theme","autoDestroy","phrases","root","extensions","selection","height","disabled","placeholder","onFocus","onBlur","onReady","onUpdate"]},A={xs:104,s:216,sm:216,m:328,md:328,l:440,lg:440,xl:552},ge=["autoLink","colon","hasFeedback","labelAlign","labelCol","htmlFor","required","validateFirst","validateStatus","validateTrigger","wrapperCol","rules","style","class"],Ce=["switch","radioButton","radio","rate"],we=["extra","help"],Pe=pe({name:"FormItem",inheritAttrs:!1,props:{item:{type:Object,default:()=>({})},grid:{type:Boolean,default:void 0}},setup(e){const{grid:B,action:m,formKey:S,prefixCls:g,formData:o,readonly:M,readonlyProps:U,disabledKeys:W,hiddenKeys:$,allDisabledKeys:z,onPressEnter:H,updateHiddenKeys:_,updateDisabledKeys:q}=te(),{isList:b,listKey:F,listName:y,rowData:k}=oe(),p=le(),{fieldValue:x,onValueChange:j}=ue({namePath:n(()=>e.item.name),initialValue:e.item.initialValue,convertValue:e.item.convertValue,transform:e.item.transform}),I=fe(),R=n(()=>e.grid??B?.value),C=n(()=>e.item.fieldType??"text"),c=n(()=>s(e.item.readonly??M?.value,o.value,k?.value)),G=n(()=>ne({},U?.value,e.item.readonlyProps)),Y=n(()=>W.value.map(a=>a.split(":")[1])),Q=n(()=>$.value.map(a=>a.split(":")[1])),D=n(()=>e.item.ignoreWidth??Ce.includes(C.value)),f=n(()=>s(e.item.formItemProps,o.value)??{}),T=n(()=>P({...N(f.value,ge),name:c.value?void 0:e.item.name,htmlFor:c.value?void 0:f.value?.htmlFor??`form-${S.value??""}-${e.item.key}`,rules:c.value?void 0:s(e.item.rules??f.value.rules,o.value,m)})),J=a=>{const{clear:t}=e.item.linkage??{};if(t){const l=s(t,a,o.value)??[];l.length>0&&l.forEach(i=>{const d=b?[...y?.value??[],...O(i)].filter(ae=>ae!==void 0).flat(1):O(i);typeof de(o.value,d)<"u"&&se(o.value,d,void 0)})}},V=n(()=>{const a=s(e.item.fieldProps??{},o.value),t={...a,id:a?.id??`form-${S.value??""}-${e.item.key}`,disabled:s(e.item.disabled??a?.disabled,o.value,k?.value)??z.value.includes(e.item.key)?!0:void 0,placeholder:e.item.placeholder??a?.placeholder,options:e.item.options??a?.options??a?.treeData,allowClear:e.item.allowClear??a?.allowClear??!0};return P({valueEnum:e.item.valueEnum,dependencies:e.item.dependencies,readonly:c.value,readonlyProps:G.value,request:e.item.request,params:e.item.params,onChange:(l,...i)=>{J(l),j(l),e.item.onChange?.(l,...i,m)},...L[C.value]?N(t,L[C.value]):t})}),X=n(()=>{const t={...s(e.item.fieldProps??{},o.value)?.style};return e.item.width&&!A[e.item.width]?t.width=re(e.item.width)?e.item.width+"px":e.item.width:R?.value&&(t.maxWidth="100%",t.width="100%"),D.value&&Reflect.deleteProperty(t,"width"),P(t)}),Z=n(()=>{const a=e.item.width&&A[e.item.width],t={[`${g}-field`]:!!a,[`${g}-field-${e.item.width}`]:a&&!D.value};return e.item.className&&(t[e.item.className]=!0),t}),ee=n(()=>{const a={};if(we.forEach(t=>{const l=h(f.value[t],p);l&&(a[t]=()=>r(v,{vnode:l,props:{formData:o.value}},null))}),e.item.title){const t=h(e.item.extra?.label,p);a.label=()=>r(he,null,[r("div",{class:`${g}-item-title`,style:f.value.titleStyles},[r(ce,{title:e.item.title,tooltip:e.item.tooltip},null)]),r("div",{class:`${g}-item-title-extra`},[r(v,{vnode:t,props:{formData:o.value}},null)])])}return a});return w(x,a=>{const{linkage:t}=e.item;if(t){const{hidden:l,disabled:i}=t;if(l){const d=s(l,a,o.value)??[];K(d,Q.value)||_(e.item.key,b?d.map(u=>`${F}_${u}`):d)}if(i){const d=s(i,a,o.value)??[];K(d,Y.value)||q(e.item.key,b?d.map(u=>`${F}_${u}`):d)}}},{immediate:!0}),w(I,()=>{e.item.onInit?.(I.value)}),w(c,()=>{c.value&&m.clearValidate(e.item.name)}),w(()=>T.value?.rules,()=>{m.clearValidate(e.item.name)}),()=>{const a=h(e.item.renderFormItem,p),t=h(e.item.extra?.item,p),l=E[C.value]??E.text;let i=r(l,ve({ref:I,value:x.value},V.value,{style:X.value,class:Z.value,onPressEnter:H}),null);a&&(i=r(v,{vnode:a,props:{value:x.value,onChange:V.value.onChange,defaultDom:i,formData:o.value,action:m,listName:y?.value,name:e.item.name}},null)),t&&(i=r("div",{style:"display: flex; flex-direction: row; justify-content: flex-start; align-items: center;"},[i,r("div",{style:"margin-inline-start: 5px; flex-shrink: 0;"},[r(v,{vnode:t,props:{formData:o.value,listName:y?.value,name:e.item.name}},null)])]));const d=r(ie.Item,T.value,{default:()=>[i],...ee.value}),u=h(e.item.render,p);return r(me,{colProps:e.item.colProps,grid:R.value},{default:()=>[u?r(v,{vnode:u,props:{formData:o.value,defaultDom:d}},null):d]})}}});export{Pe as default};
